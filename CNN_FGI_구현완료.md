# CNN Fear & Greed Index 스크래핑 기능 구현 완료

## ✅ 구현 완료 사항

### 1. CNN 스크래핑 기능
- ✅ CNN 페이지 (https://edition.cnn.com/markets/fear-and-greed)에서 실시간 스크래핑
- ✅ 수치 (0~100) 추출
- ✅ 상태명 추출 (Extreme Fear, Fear, Neutral, Greed, Extreme Greed)
- ✅ BeautifulSoup 기반 HTML 파싱
- ✅ 여러 방법으로 데이터 추출 시도 (안정성 향상)

### 2. 백엔드 API
- ✅ `GET /market/fear-greed` - CNN FGI 조회 (변화율 및 트리거 신호 포함)
- ✅ `force_refresh` 파라미터로 강제 새로고침 지원
- ✅ 15분 캐싱 (메모리 기반)
- ✅ 네트워크 오류·구조 변경 예외 처리
- ✅ API 백업 (Alternative.me API 사용)

### 3. 데이터 구조
- ✅ FGI 값 (0~100)
- ✅ 상태명 (한국어 변환)
- ✅ 변화량 (change)
- ✅ 변화율 (change_rate, %)
- ✅ 이전 값 (previous_value)
- ✅ 트리거 신호 (trigger_signals)
- ✅ 신뢰도 향상 (confidence_boost)
- ✅ 행동 가이드 (action_guide)

### 4. FGI 트리거 신호 알고리즘
- ✅ FGI 0~40 (공포·극공포): "QLD 매수 신호 강화 가능성"
- ✅ FGI 60~100 (탐욕·극탐욕): "VIG 유지/매수 권장, QLD 비중 축소"
- ✅ FGI 40~60 (중립): "기술지표(RSI/MA200) 기반 판단 권장"
- ✅ 공포 구간 반등 (15→20): "공포 구간 반등 시작 → QLD 진입 신뢰도↑"
- ✅ 탐욕 구간 약화 (75→68): "탐욕 구간 약화 → VIG 유지 신뢰도↑"
- ✅ 급격한 변화 감지 (변화량 ≥10)

### 5. 스위칭 알고리즘 통합
- ✅ FGI 0~40: QLD 매수 신호 강화
- ✅ FGI 60~100: VIG 매수 신호 강화, QLD 비중 축소
- ✅ FGI 40~60: 기술지표 기반 판단 유지
- ✅ 트리거 신호 기반 신뢰도 조정
- ✅ 포트폴리오 비중 추천에 반영

### 6. 프론트엔드 통합
- ✅ 대시보드: FGI 카드에 변화율 및 행동 가이드 표시
- ✅ 시장 심리 페이지: FGI 상세 정보, 트리거 신호, 행동 가이드
- ✅ 스위칭 시그널 페이지: FGI 값, 변화율, 트리거 신호 표시
- ✅ 한국어 상태명 표시
- ✅ 색상 기반 시각화

## 📊 API 응답 구조

### GET /market/fear-greed
```json
{
  "date": "2024-01-01T12:00:00",
  "value": 45,
  "classification": "Fear",
  "change": 5,
  "change_rate": 12.5,
  "previous_value": 40,
  "trigger_signals": [
    "공포 구간 - QLD 매수 신호 강화 가능성",
    "공포 구간 반등 시작 (40→45) → QLD 진입 신뢰도↑"
  ],
  "confidence_boost": 0.1,
  "action_guide": "공포 구간 반등 시작 (40→45) → QLD 진입 신뢰도↑"
}
```

## 🔧 스위칭 알고리즘 로직

### FGI 기반 판단 규칙

1. **공포 구간 (FGI 0~40)**
   - QLD 보유 시: 유지 또는 추가 매수
   - VIG 보유 시: QLD로 스위칭 고려 (기술지표 양호 시)
   - 신뢰도: 0.85 ~ 0.95

2. **탐욕 구간 (FGI 60~100)**
   - VIG 보유 시: 유지 강화
   - QLD 보유 시: VIG로 스위칭 고려
   - 신뢰도: 0.75 ~ 0.95

3. **중립 구간 (FGI 40~60)**
   - 기술지표(RSI/MA200) 기반 판단 유지

### 트리거 신호 예시

- **공포 구간 반등**: 15→20 상승 시 "공포 구간 반등 시작 → QLD 진입 신뢰도↑"
- **탐욕 구간 약화**: 75→68 하락 시 "탐욕 구간 약화 → VIG 유지 신뢰도↑"
- **급격한 변화**: 변화량 ≥10 시 경고 메시지

## 🎯 포트폴리오 비중 추천 반영

### FGI 기반 점수 조정

- **공포 구간 (0~40)**: QLD 점수 +20~30, VIG 점수 -10~15
- **탐욕 구간 (60~100)**: VIG 점수 +20~30, QLD 점수 -15
- **중립 구간 (40~60)**: 기술지표 기반 판단

### 변화율 반영

- 공포 구간 반등 시작: QLD 점수 +5
- 탐욕 구간 약화: VIG 점수 +5

## 🚀 사용 방법

### 1. FGI 새로고침
```
GET /market/fear-greed?force_refresh=true
```

### 2. 일반 조회 (캐시 사용)
```
GET /market/fear-greed
```

## 📝 한국어 상태명 매핑

- **Extreme Fear** → 극공포
- **Fear** → 공포
- **Neutral** → 중립
- **Greed** → 탐욕
- **Extreme Greed** → 극탐욕

## 🔍 안정성 향상 기능

1. **캐싱**: 15분 캐시로 과도한 요청 방지
2. **예외 처리**: 네트워크 오류, 구조 변경 대응
3. **백업 API**: CNN 실패 시 Alternative.me API 사용
4. **다중 파싱 방법**: 여러 방법으로 데이터 추출 시도

## ✨ 통합 완료

- ✅ 대시보드: FGI 위젯 개선
- ✅ 시장 심리 페이지: FGI 상세 정보 및 트리거 신호
- ✅ 스위칭 시그널 페이지: FGI 정보 표시
- ✅ 스위칭 알고리즘: FGI 기반 로직 통합
- ✅ 포트폴리오 추천: FGI 기반 점수 조정
- ✅ 모든 텍스트: 한국어 출력

---

**구현 완료일**: 2024년
**상태**: ✅ 완전 구현 완료



